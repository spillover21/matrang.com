# ‚úÖ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø DOCUMENSO API V2 –ó–ê–í–ï–†–®–ï–ù–ê

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –§–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ e:\pitbull\public_html

#### api/ContractService.php
- **–ò–∑–º–µ–Ω–µ–Ω–æ:** Endpoint —Å `create_envelope.php` –Ω–∞ `create_envelope_api_v2.php`
- **–°—Ç—Ä–æ–∫–∞ 27:** –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π API V2
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

#### api/create_envelope_api_v2.php  
- **–°–æ–∑–¥–∞–Ω:** –ù–æ–≤—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Documenso API V2
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ PDF —á–µ—Ä–µ–∑ Python (fill_pdf.py)
  - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ envelope —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API V2
  - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PENDING
  - ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ signing URLs –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∏ –ø—Ä–æ–¥–∞–≤—Ü–∞
  - ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –¥–ª—è contracts_api.php
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ VPS 72.62.114.139

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ:**
```json
{
  "success": true,
  "envelope_id": "envelope_ixcnuwxyehmhnsvm",
  "signing_url": "http://72.62.114.139:9000/sign/YWXpeV7IbtpatvEfycUB6",
  "seller_signing_url": "http://72.62.114.139:9000/sign/tM7QESt6VWBI6bH0Zq13T",
  "seller_token": "tM7QESt6VWBI6bH0Zq13T",
  "seller_email": "greatlegacybully@gmail.com",
  "recipient_id": "test@example.com",
  "contract_id": "contract-1770490560-9091"
}
```

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ PDF —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ Envelope —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ Documenso
- ‚úÖ –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ PENDING
- ‚úÖ –°—Å—ã–ª–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –û–±–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (seller + buyer) –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø
- ‚úÖ –ü–æ–ª—è –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è (—á–µ—Ä–µ–∑ DocumentAuditLog trigger)

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Production

### –í–∞—Ä–∏–∞–Ω—Ç 1:Hostinger cPanel (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–§–∞–π–ª—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ File Manager:**
1. `api/ContractService.php` ‚Üí `/public_html/api/`
2. `api/create_envelope_api_v2.php` ‚Üí –ù–ï –ù–£–ñ–ù–û (—É–∂–µ –Ω–∞ VPS 72.62.114.139)

**–®–∞–≥–∏:**
1. –í–æ–π—Ç–∏ –≤ Hostinger cPanel
2. –û—Ç–∫—Ä—ã—Ç—å File Manager
3. –ü–µ—Ä–µ–π—Ç–∏ –≤ `/public_html/api/`
4. –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `ContractService.php`
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞: 644 (rw-r--r--)
6. –ì–æ—Ç–æ–≤–æ! ‚úÖ

### –í–∞—Ä–∏–∞–Ω—Ç 2: FTP/SFTP

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Hostinger FTP
# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª:
# –õ–æ–∫–∞–ª—å–Ω—ã–π: e:\pitbull\public_html\api\ContractService.php
# –£–¥–∞–ª–µ–Ω–Ω—ã–π: /public_html/api/ContractService.php
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: SSH (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Hostinger SSH
cd /home/yourusername/public_html/api/

# –°–æ–∑–¥–∞—Ç—å backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
cp ContractService.php ContractService.php.backup

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é (—á–µ—Ä–µ–∑ upload –∏–ª–∏ paste content)
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è VPS

**–í—Å–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ VPS 72.62.114.139:**
- ‚úÖ Documenso API Token: `api_iffjvv698wn27tji`
- ‚úÖ Endpoint: `http://72.62.114.139:8080/create_envelope_api_v2.php`
- ‚úÖ API Key: `matrang_secret_key_2026`
- ‚úÖ PostgreSQL triggers (6 —à—Ç—É–∫)
- ‚úÖ Python fill_pdf.py script
- ‚úÖ Template.pdf (—à–∞–±–ª–æ–Ω –¥–æ–≥–æ–≤–æ—Ä–∞)

**–ù–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–∞ VPS –ù–ï –ù–£–ñ–ù–û!** ‚úÖ

## üìä –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É** –≤ ContractManager (React)
2. **–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST** –Ω–∞ `/api/contracts_api.php`
3. **contracts_api.php –≤—ã–∑—ã–≤–∞–µ—Ç** `ContractService->createAndSendContract()`
4. **ContractService –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç** –¥–∞–Ω–Ω—ã–µ –Ω–∞ VPS: `http://72.62.114.139:8080/create_envelope_api_v2.php`
5. **VPS –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**
   - –ó–∞–ø–æ–ª–Ω—è–µ—Ç PDF —á–µ—Ä–µ–∑ Python
   - –°–æ–∑–¥–∞–µ—Ç envelope —á–µ—Ä–µ–∑ Documenso API V2
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ PENDING
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç signing URLs
6. **contracts_api.php —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç** –¥–æ–≥–æ–≤–æ—Ä –≤ `data/contracts.json`
7. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç** —Å—Å—ã–ª–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
8. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ DB trigger

## üéØ –ß—Ç–æ –ò–ó–ú–ï–ù–ò–õ–û–°–¨ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–µ–π?

### –ë—ã–ª–æ (—Å—Ç–∞—Ä—ã–π create_envelope.php):
- ‚ùå SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î
- ‚ùå 404 –æ—à–∏–±–∫–∏ –Ω–∞ signing URLs
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ DocumentMeta, qrToken
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö email
- ‚ùå –û–±—Ö–æ–¥ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ª–æ–≥–∏–∫–∏ Documenso

### –°—Ç–∞–ª–æ (–Ω–æ–≤—ã–π create_envelope_api_v2.php):
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Documenso API V2
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è signing URLs
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Documenso
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ email —á–µ—Ä–µ–∑ triggers
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

## üîç –û—Ç–ª–∞–¥–∫–∞

**–õ–æ–≥–∏ –Ω–∞ VPS:**
```bash
ssh root@72.62.114.139
tail -f /tmp/documenso_api_debug.log
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```bash
# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
curl -X POST http://72.62.114.139:8080/create_envelope_api_v2.php \
  -H "Content-Type: application/json" \
  -H "X-API-Key: matrang_secret_key_2026" \
  -d '{
    "kennelEmail": "test@example.com",
    "kennelName": "Test Kennel",
    "buyerEmail": "buyer@example.com",
    "buyerName": "Test Buyer",
    "dogName": "Test Dog",
    "dogBreed": "Test Breed",
    "dogBirthDate": "2024-01-01",
    "dogGender": "Male",
    "dogColor": "Black",
    "price": "100000",
    "contractDate": "2025-02-08"
  }'
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–ï –ú–ï–ù–Ø–¢–¨** endpoint –≤ ContractService.php –æ–±—Ä–∞—Ç–Ω–æ!
2. **–ù–ï –£–î–ê–õ–Ø–¢–¨** —Ñ–∞–π–ª—ã –Ω–∞ VPS: `/var/www/documenso-bridge/`
3. **–ù–ï –ò–ó–ú–ï–ù–Ø–¢–¨** API Token –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. **Backup –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:** –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å backup —Ç–µ–∫—É—â–∏—Ö —Ñ–∞–π–ª–æ–≤

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `/tmp/documenso_api_debug.log` –Ω–∞ VPS
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `data/debug_contracts.log` –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å VPS: `ping 72.62.114.139`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Documenso: `http://72.62.114.139:9000`

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É

- [x] –ö–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- [x] API V2 —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ VPS
- [x] Signing URLs –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
- [x] Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] **–î–µ–ø–ª–æ–π –Ω–∞ Hostinger production** ‚Üê –û–°–¢–ê–õ–û–°–¨ –°–î–ï–õ–ê–¢–¨

---

**–î–∞—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** 2026-02-08  
**–í–µ—Ä—Å–∏—è API:** Documenso API V2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ
